YUI.add("mail-ui-desktop-notifications",function(e){function s(){return!!window.Notification&&!u()}function o(){return e.mail.persist.MetaData.get(t)}function u(){return e.one("#ynano_installed_YSet")||e.one("body").hasClass("yahoo_firefox_mail_jid1-kMGMgjmcncOBpw")}function a(n){e.mail.persist.MetaData.set(t,n)}function f(e,t){var n=e&&e.trim()||"";return n.length>t?n.substr(0,t)+"...":n}function l(t,i,s,o){return t||e.fire("util:ymstats",{name:"notifications_notify_noimage",tags:{agent:NeoConfig.browser},include:{bucket:!0}}),window.Notification.permission==="granted"||NeoConfig.isWinApp?new window.Notification(f(i,n),{body:f(s,r),icon:t,lang:NeoConfig.lang,tag:o}):null}function c(){var t="https://s.yimg.com/nq/a/img/desktop-notification-mail-",n;if(e.UA.gecko)n=50;else{if(!e.UA.chrome)return"";n=80}return typeof window.devicePixelRatio!="undefined"&&window.devicePixelRatio>=2&&(n*=2),t+=n+"x"+n+"_2.png",t}function h(){return o()==="denied"?!1:o()==="granted"&&window.Notification.permission==="granted"?!1:!0}function p(){return!NeoConfig.isWinApp&&o()==="granted"&&window.Notification&&window.Notification.permission==="default"}function d(t,n,r,i,u){var a;if(NeoConfig.isWinApp||s()&&o()==="granted")a=l(u||c(),t,n,i),a&&(r?a.onclick=r:a.onclick=function(){a.close()},e.UA.chrome&&e.later(e.common.Utils.settings.value("notificationToastTimeOut",7e3),null,function(){a.close()}));return a}function v(e){s()&&h()&&!i&&(i=!0,window.Notification.requestPermission(function(t){e&&e(t)}))}function m(){var t=new window.Notification(strings.str_mail_notif_activated_hd,{body:strings.str_mail_notif_activated_bd,icon:c(),lang:NeoConfig.lang});e.fire("notificationSuccess"),t.onclick=t.close}function g(t){s()&&e.use("mail-ui-desktop-notifications-mail",function(e){e.mail.ui.mailDesktopNotifications.init(t)})}var t="neo.pref.desktopNotification",n=50,r=90,i=!1;e.namespace("mail.ui").desktopNotifications={notify:d,initNotifyModel:g,_getImageURL:c,_trimText:f,_needPermission:h,currentBrowserNeedsPermission:p,showIntroToast:m,getSavedPreference:o,setSavedPreference:a,getUserPermission:v,browserSupportNotification:s}},"1.0.0",{requires:["node","mail-persist-meta-data"].concat(NeoConfig.isWinApp?["mail-ui-windows-helper"]:[])});
