YUI.add("comms-utils-stack-tracer",function(e){function r(e){var t,n,r,i=[],o=[],u=arguments;try{while(!r&&(t=u.caller?u.caller.callee:u.callee.caller)){o.length>50&&(r="*** stack too deep, stopping");for(n=0;n<i.length;n++)t===i[n]&&(r="*** recursion, stopping");u=t.arguments,i.push(t),o.push(r||s(t))}}catch(a){o.push("*** error going to next level, may be the end of the JS stack")}e.depth=o.length,e.stack=o.join(" >> ")}function i(e){var t=[],n=e.stack.split(/\r\n|\r|\n/);e.depth=n.length,n.forEach(function(e){var n=e.split("@");n.length===2?t.push("at "+n[0]+"("+n[1]+")"):t.push(e)}),e.stack=t.join("\n")}function s(e){var t,n,r;try{n=e.toString(),r=n.match(/function\s+([^\s(]+)/),r&&r.length>1&&(t=r[1])}catch(i){}return t=t||"{?}",t=t.replace(/^(\s+)?(.*\S)(\s+)?$/g,"$2"),t}var t,n=e.namespace("comms.utils.StackTracer");n.getStack=function(e){return e=e||new Error,e.fileName&&i(e),e.stack===undefined&&r(e),e.lineNumber=e.lineNumber||e.line,e.fileName=e.fileName||e.sourceURL,e.stack},n.depth=function(){var e=new Error;return t=1,n.getStack(e),t=0,e.depth-1}},"1.0.0");
YUI.add("common-utils-error",function(e){var t=e.common.Utils,n,r=0,i=1;n=function(){function n(){var t,n=arguments,i,a,f,l,c="",h,p,d=[],v=[],m=NeoConfig.isCorpmail?"critical":"sample",g=NeoConfig.browser&&NeoConfig.browser.split("_")[0]||"unknown",y=e.mail.ui.Recorder,b=0;while(b<n.length)t=n[b++],typeof t=="string"?d.push(t):t instanceof Error?l=t:v.push(t);a=d[0],f=s(d[1],a),l&&(c=l.name+":"+l.message,l.name==="NetworkError"&&(f="NetworkError"));try{v[1]&&l&&(h=e.comms.utils.StackTracer.getStack(l))}catch(w){}f!=="CUSTOM"&&(f==="WONTFIX"?i="jsexception_wontfix":r<1e3?(i="jsexception",r++):r===1e3&&(i="jsexception_overlimit",r++)),i&&e.fire("util:ymstats",{name:i,tags:{type:f,browser:g,mp:!NeoConfig.hasAds},include:{env:!0}}),p={type:f,message:a,exceptionMessage:c,count:r,failedModules:u(),corpmail:NeoConfig.isCorpmail?1:0,stack:h&&h.split("\n")||[]},v[3]||(f==="EXT_UNHANDLED"&&(m="critical"),f.indexOf("apihook")!==-1&&(m="critical"),e.fire("SplunkLog",f==="CUSTOM"?"debug_customexception":"debug_jsexception",p,m)),v[2]&&e.common.Utils.features.enabled("showPinkbox")&&o(p,l),y&&y.getLastClickSig(!0)}function s(t,n){return n&&n.indexOf("PADDINGXX")>-1?"WONTFIX":NeoConfig.isCorpmail&&n&&n.indexOf("Missing Module: tictac-att")>-1&&e.one(".jiveAnywhereResetCss")?"WONTFIX":n&&n.indexOf("Uncaught TypeError: this.get(...).querySelectorAll is not a function")>-1?"WONTFIX":t||"CUSTOM"}function o(e,n){function p(){u.removeEventListener?u.removeEventListener("click",p,!1):u.detachEvent&&u.detachEvent("onclick",p),o.removeEventListener?o.removeEventListener("click",d,!1):o.detachEvent&&o.detachEvent("onclick",d),a.removeChild(s),s.removeChild(o),o.removeChild(u),s=o=u=null}function d(){a.className.indexOf("collapsed")===-1?a.className="collapsed":a.className=""}var r=document,s=r.createElement("div"),o,u,a,f,l,c="",h={sourcetype:"st_neo_clientlog_json",key:"debug_jsexception","d.type":e.type,"d.message":e.message,"d.exceptionMessage":e.exceptionMessage};n&&n.stack&&window.console&&console.log&&console.log(n.stack);for(f in e)l=e[f],f==="stack"&&(l=l.join("\n"),l=l.replace(/</g,"[").replace(/>/g,"]").replace(/\n/g,"<br>"),l=t.replaceURLWithHTMLLinks(l)),c+="<dt>"+f+'</dt><dd class="'+f+'">'+l+"</dd>";c=c.split("&"),c=c.join("&amp;&#8203;"),s.className="error-dlg",s.innerHTML=['<div class="error-dlg-hd" id="pinkBoxHdr'+i+'">',"ERROR "+i+" "+e.message+'<span id="pinkBoxClose'+i+'" class="error-dlg-close">X</span>',"</div>",'<div class="error-dlg-bdy">','<dt><a href="'+t.getSplunkLink(h)+'" target="_blank">Search Splunk</a></dt><dd></dd>',"<dl>",c,"</dl>","</div>"].join(""),a=r.getElementById("pinkBoxHolder"),a||(a=r.createElement("div"),a.id="pinkBoxHolder",a.className="collapsed",r.body.appendChild(a)),a.appendChild(s),o=r.getElementById("pinkBoxHdr"+i),u=r.getElementById("pinkBoxClose"+i),u.addEventListener?u.addEventListener("click",p,!1):u.attachEvent&&u.attachEvent("onclick",p),o.addEventListener?o.addEventListener("click",d,!1):o.attachEvent&&o.attachEvent("onclick",d),i++}function u(){var e,t,n=[];try{t=globals.failures;for(e in t)n.push(e+":"+t[e]);n.sort(),n=n.join(", ")}catch(r){n=r.toString()}return n}e.mix(this,{report:n,getErrorType:s})},e.namespace("common.Utils").error=new n,typeof globals=="undefined"&&(globals={}),globals.report=e.common.Utils.error.report},"1.0.0",{requires:["mail-common-utils-features","common-ui-tabs-base","comms-utils-stack-tracer","ymma-stats","mail-ui-recorder"]});
